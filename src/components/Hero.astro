---
import { SITE } from '../data/site'
import Check from './icons/Check.astro'
import { LINKS } from '../data/site'

interface Props {
  bgImage?: string
  preloadBg?: boolean
  showVideo?: boolean
  videoSrc?: string
  videoSrcWebm?: string
  poster?: string
}

const {
  bgImage = '/media/ambulancias.jpg',
  preloadBg = false,
  showVideo = true,
  videoSrc = '/media/ucm.mp4',
  videoSrcWebm = '',
  poster = '/images/ucm-poster.png'
} = Astro.props

// REEMPLAZAMOS cleanPhone ‚Üí LINKS oficiales
const wa = LINKS.wa()
const call = LINKS.call()
---

<section id="hero" class="relative overflow-hidden" aria-labelledby="hero-title">
  <!-- Fondo -->
  <div class="absolute inset-0 -z-10">
    <img
      src={bgImage}
      alt=""
      loading="eager"
      fetchpriority="high"
      decoding="async"
      class="h-full w-full object-cover"
      aria-hidden="true"
    />
    <div class="absolute inset-0 bg-black/45 md:bg-black/40"></div>
    <div class="absolute inset-0 bg-gradient-to-r from-black/35 via-black/25 to-transparent"></div>
  </div>

  <div class="relative">
    <div class="max-w-6xl mx-auto px-4 py-2 md:py-32 grid md:grid-cols-2 items-center gap-10">
      <div class="max-w-2xl">
        <!-- H1 optimizado -->
        <h1
          id="hero-title"
          class="text-4xl md:text-6xl font-extrabold leading-tight text-white drop-shadow-lg"
        >
          Planes UCM: Asistencia M√©dica a Domicilio 24/7
        </h1>

        <!-- P√°rrafo optimizado (m√°s compacto para mobile) -->
        <p class="mt-6 text-xl text-slate-100/95 leading-relaxed">
          Contrata tu plan con <strong>HOY</strong> y accede a atenci√≥n m√©dica a domicilio, telemedicina
          y orientaci√≥n <strong>24/7</strong>. Te asesoro y gestiono tu contrataci√≥n en minutos.
        </p>

        <!-- Lista de beneficios -->
        <ul class="mt-8 space-y-3 text-slate-100 text-lg">
          <li class="flex items-start gap-3">
            <Check class="mt-1 text-emerald-400 shrink-0" size={22} />
            <span>Cobertura <strong>24/7</strong> con orientaci√≥n m√©dica</span>
          </li>
          <li class="flex items-start gap-3">
            <Check class="mt-1 text-emerald-400 shrink-0" size={22} />
            <span><strong>Atenci√≥n a domicilio</strong> + telemedicina inmediata</span>
          </li>
          <li class="flex items-start gap-3">
            <Check class="mt-1 text-emerald-400 shrink-0" size={22} />
            <span>Planes <strong>familiares</strong> y <strong>empresas</strong></span>
          </li>
          <li class="flex items-start gap-3">
            <Check class="mt-1 text-emerald-400 shrink-0" size={22} />
            <span>Gesti√≥n r√°pida con ejecutiva</span>
          </li>
        </ul>

        <!-- CTAs con cta names correctos -->
        <div class="mt-8 flex flex-wrap gap-4">
          <a
            href={wa}
            target="_blank"
            data-cta="whatsapp"
            class="rounded-xl w-full text-center px-7 py-4 text-lg bg-emerald-600 text-white font-semibold hover:bg-emerald-700 shadow-lg"
            rel="noopener"
            aria-label="Cotizar plan UCM por WhatsApp"
          >
            Cotizar por WhatsApp
          </a>

          <a
            href={call}
            data-cta="llamar"
            class="rounded-xl w-full text-center px-7 py-4 text-lg bg-[#204D8D] text-white font-semibold hover:bg-[#1b3f74] shadow-lg"
            aria-label="Llamar a la ejecutiva de ventas UCM"
          >
            Llamar a la ejecutiva
          </a>

          <a
            href="#planes"
            class="w-full text-center px-7 py-3 text-base font-semibold text-white/90 hover:text-white border border-white/30 rounded-xl hover:bg-white/10 transition"
            aria-label="Ver planes UCM disponibles"
          >
            Ver planes
          </a>
        </div>

        <!-- Trust hints compactos -->
        <ul class="mt-4 flex flex-wrap gap-3 text-xs text-slate-200/90">
          <li class="rounded-full border border-white/20 px-3 py-1">Contrato inmediato</li>
          <li class="rounded-full border border-white/20 px-3 py-1">Cobertura RM + V Regi√≥n</li>
          <li class="rounded-full border border-white/20 px-3 py-1">Soporte 24/7</li>
        </ul>

        <p class="mt-2 text-slate-200/90 text-sm">
          Cobertura: <a href="#cobertura" class="underline hover:no-underline">Santiago (RM)</a> ¬∑
          <a href="#cobertura" class="underline hover:no-underline">Vi√±a del Mar</a> ¬∑
          <a href="#cobertura" class="underline hover:no-underline">Valpara√≠so</a>
        </p>
      </div>

      {
        showVideo && (
          <figure class="relative md:justify-self-end">
            <div class="rounded-2xl backdrop-blur border border-white/60 shadow-xl p-3 md:p-28">
              <div class="relative w-full max-w-[380px] md:max-w-[420px]">
                <div class="aspect-[9/16] overflow-hidden rounded-xl">
                  <video
                    id="heroVideo"
                    class="h-full w-full object-cover"
                    title="Planes UCM ‚Äì Asistencia M√©dica 24/7"
                    poster={poster}
                    preload="metadata"
                    muted
                    playsinline
                    autoplay
                    loop
                  >
                    {videoSrcWebm && <source src={videoSrcWebm} type="video/webm" />}
                    {videoSrc && <source src={videoSrc} type="video/mp4" />}
                    Tu navegador no puede reproducir el video.
                  </video>
                </div>
                <button
                  type="button"
                  id="unmuteBtn"
                  class="absolute bottom-3 right-3 rounded-full bg-slate-900/80 text-white text-xs px-3 py-2 hover:bg-black"
                  aria-label="Activar sonido del video"
                  aria-pressed="false"
                >
                  üîä Activar sonido
                </button>
              </div>
            </div>
          </figure>
        )
      }
    </div>
  </div>
</section>

<script>
  const v = document.getElementById('heroVideo')
  const b = document.getElementById('unmuteBtn')
  if (v && b) {
    b.addEventListener('click', () => {
      try {
        v.muted = false
        v.volume = 0.2
        const p = v.play()
        if (p && p.catch) p.catch(() => {})
        b.setAttribute('aria-pressed', 'true')
        b.style.display = 'none'
      } catch (_) {}
    })
  }
</script>
